---
import { actions, isInputError } from "astro:actions";

export const prerender = false;

const result = Astro.getActionResult(actions.contact);
---

<div>
  {
    result?.data && (
      <div class="mb-6 rounded-xl border-2 border-amber-400/50 bg-gradient-to-r from-amber-50 to-amber-100 px-5 py-4 text-amber-900 animate-slide-in-down shadow-lg" style="font-family: var(--font-mono);">
        <p class="font-semibold text-sm md:text-base">✨ {result.data.message}</p>
      </div>
    )
  }

  {
    result?.error && !isInputError(result.error) && (
      <div class="mb-6 rounded-xl border-2 border-coral-400 bg-gradient-to-r from-red-50 to-coral-100 px-5 py-4 text-red-800 animate-slide-in-down shadow-lg" style="font-family: var(--font-mono);">
        <p class="font-semibold text-sm md:text-base">⚠️ {result.error.message}</p>
      </div>
    )
  }

  <form
    method="POST"
    action={actions.contact}
    class="flex flex-col justify-center space-y-4"
  >
    <div class="space-y-1">
      <input
        type="text"
        name="name"
        placeholder="Your name"
        class="w-full h-12 px-4 text-base border-2 border-slate-300 bg-white/80 text-slate-800 placeholder-slate-500 rounded-xl focus:outline-none focus:border-amber-400 focus:ring-4 focus:ring-amber-400/20 transition-all duration-300 backdrop-blur-sm"
        style="font-family: var(--font-mono);"
      />
      {
        isInputError(result?.error) && result.error.fields.name && (
          <span class="text-xs text-coral-600 animate-shake inline-block font-semibold ml-1" role="alert" style="font-family: var(--font-mono);">
            {result.error.fields.name.join(", ")}
          </span>
        )
      }
    </div>
    <div class="space-y-1">
      <input
        type="text"
        name="email"
        placeholder="your.email@example.com"
        class="w-full h-12 px-4 text-base border-2 border-slate-300 bg-white/80 text-slate-800 placeholder-slate-500 rounded-xl focus:outline-none focus:border-amber-400 focus:ring-4 focus:ring-amber-400/20 transition-all duration-300 backdrop-blur-sm"
        style="font-family: var(--font-mono);"
      />
      {
        isInputError(result?.error) && result.error.fields.email && (
          <span class="text-xs text-coral-600 animate-shake inline-block font-semibold ml-1" role="alert" style="font-family: var(--font-mono);">
            {result.error.fields.email.join(", ")}
          </span>
        )
      }
    </div>
    <div class="space-y-1">
      <textarea
        name="message"
        placeholder="Your message here..."
        rows={4}
        class="w-full px-4 py-3 text-base border-2 border-slate-300 bg-white/80 text-slate-800 placeholder-slate-500 rounded-xl focus:outline-none focus:border-amber-400 focus:ring-4 focus:ring-amber-400/20 transition-all duration-300 backdrop-blur-sm resize-none"
        style="font-family: var(--font-mono);"
      ></textarea>
      {
        isInputError(result?.error) && result.error.fields.message && (
          <span class="text-xs text-coral-600 animate-shake inline-block font-semibold ml-1" role="alert" style="font-family: var(--font-mono);">
            {result.error.fields.message.join(", ")}
          </span>
        )
      }
    </div>
    <button
      type="submit"
      class="self-center h-12 px-8 font-bold text-white rounded-xl transition-all duration-300 transform hover:scale-105 active:scale-95 shadow-lg hover:shadow-xl"
      style="background: linear-gradient(135deg, var(--color-amber) 0%, var(--color-coral) 100%); font-family: var(--font-mono);"
    >
      Send Message ✉️
    </button>
  </form>
</div>
